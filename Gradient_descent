import random
import numpy as np
import time
import matplotlib.pyplot as plt

def gradient_descent(x,y,theta):
    time_begin = time.time()
    X=np.mat(x)
    Y=np.mat(y).T
    Theta=np.mat(theta).T
    Hy=X*Theta
    a=0.001
    loss=[]
    item_count=30
    for i in range(item_count):
        Hy=X*Theta
        J=(1.0/(2*len(y)))*np.sum(np.square(Hy-Y))
        loss.append(J)
        Theta=Theta-a*(1.0)/len(y)*np.sum(X.T*(Hy-Y))
    plt.plot(range(item_count),loss)
    plt.show()
